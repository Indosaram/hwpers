# HWP Writer - 미구현 기능 목록

## 개요
이 문서는 현재 HWP Writer에서 구현되지 않았거나 불완전하게 구현된 기능들을 정리한 것입니다.

## 1. 완전히 미구현된 기능

### 1.1 머리글/바닥글 (Header/Footer)
- **현재 상태**: `HeaderFooterCollection` 모델만 존재
- **필요한 구현**:
  - `add_header()`, `add_footer()` 메서드
  - 페이지별 다른 머리글/바닥글 설정
  - 첫 페이지/홀수/짝수 페이지 구분
  - 페이지 번호 실제 렌더링 로직

### 1.2 텍스트 박스 (Text Box)
- **현재 상태**: `text_box.rs` 모델 파일만 존재
- **필요한 구현**:
  - `add_text_box()` 메서드
  - 플로팅 텍스트 박스 위치 지정
  - 텍스트 박스 내 서식 지원
  - 텍스트 박스 테두리 및 배경색

### 1.3 각주/미주 (Footnote/Endnote)
- **현재 상태**: 전혀 구현되지 않음
- **필요한 구현**:
  - `add_footnote()`, `add_endnote()` 메서드
  - 자동 번호 매기기
  - 각주 구분선 스타일
  - 각주/미주 참조 링크

### 1.4 북마크 및 목차 (Bookmark & TOC)
- **현재 상태**: 구현되지 않음
- **필요한 구현**:
  - `add_bookmark()` 메서드
  - `generate_table_of_contents()` 메서드
  - 제목 스타일 기반 자동 목차 생성
  - 페이지 번호 자동 업데이트

### 1.5 단락 서식 (Paragraph Formatting)
- **현재 상태**: 기본적인 단락만 지원
- **필요한 구현**:
  - 텍스트 정렬 (왼쪽/가운데/오른쪽/양쪽)
  - 들여쓰기/내어쓰기
  - 줄 간격 설정
  - 단락 전후 간격
  - 탭 설정

### 1.6 페이지 제어 (Page Control)
- **현재 상태**: 구현되지 않음
- **필요한 구현**:
  - `add_page_break()` 메서드
  - `add_section_break()` 메서드
  - 단 나누기
  - 페이지 방향 혼합 (같은 문서 내 세로/가로)

### 1.7 고급 테이블 기능 (Advanced Table Features)
- **현재 상태**: 기본 테이블만 지원
- **필요한 구현**:
  - 셀 병합 (가로/세로)
  - 테이블 내 테이블 (중첩 테이블)
  - 테이블 스타일 템플릿
  - 테이블 캡션
  - 반복 헤더 행

### 1.8 수식 편집기 (Equation Editor)
- **현재 상태**: 구현되지 않음
- **필요한 구현**:
  - 수학 수식 입력
  - LaTeX 수식 지원
  - 화학식 지원

### 1.9 차트 및 도표 (Charts & Diagrams)
- **현재 상태**: 구현되지 않음
- **필요한 구현**:
  - 막대/선/원 그래프
  - 조직도
  - 순서도

### 1.10 양식 컨트롤 (Form Controls)
- **현재 상태**: 구현되지 않음
- **필요한 구현**:
  - 체크박스
  - 라디오 버튼
  - 드롭다운 목록
  - 텍스트 입력 필드

## 2. 불완전하게 구현된 기능

### 2.1 하이퍼링크 (Hyperlinks)
- **현재 상태**: API는 있으나 serialization 불완전
- **문제점**:
  - `Paragraph`의 `hyperlinks` 필드에 추가되지만 serializer에서 실제 처리 없음
  - HWP 파일에 저장 시 실제로 작동하는지 미검증
- **필요한 개선**:
  - Serializer에 하이퍼링크 직렬화 로직 추가
  - 컨트롤 ID와 연결
  - 실제 HWP에서 클릭 가능한지 검증

### 2.2 페이지 설정 (Page Settings)
- **현재 상태**: API는 있으나 적용 불완전
- **문제점**:
  - `PageDef`가 섹션에 설정되지만 serializer에서 불완전한 처리
  - 다단 설정이 실제 렌더링에 반영되는지 미확인
- **필요한 개선**:
  - Serializer에서 완전한 PageDef 직렬화
  - 다단 텍스트 흐름 처리
  - 여백 실제 적용 검증

### 2.3 이미지 (Images)
- **현재 상태**: 기본 기능만 구현
- **문제점**:
  - BinData 섹션에 이미지 저장 로직 불완전
  - 이미지 크기/위치 제어 제한적
  - 이미지 포맷 변환 미지원
- **필요한 개선**:
  - 완전한 BinData 통합
  - 이미지 크기 조절 옵션
  - 이미지 위치 지정 (인라인/플로팅)
  - 이미지 회전/자르기

### 2.4 리스트 (Lists)
- **현재 상태**: 기본 리스트만 지원
- **문제점**:
  - 중첩 리스트 미지원
  - 커스텀 번호 시작값 설정 불가
  - 리스트 스타일 제한적
- **필요한 개선**:
  - 다단계 리스트 지원
  - 리스트 재시작 번호 설정
  - 커스텀 불릿 문자

### 2.5 텍스트 스타일 (Text Styles)
- **현재 상태**: 기본 스타일만 지원
- **문제점**:
  - 취소선, 윗첨자, 아래첨자 미지원
  - 텍스트 그림자, 외곽선 미지원
  - 문자 간격, 장평 조절 미지원
- **필요한 개선**:
  - 고급 텍스트 효과
  - 세부적인 간격 조절
  - 텍스트 변형 효과

## 3. 시스템 레벨 개선 필요사항

### 3.1 문서 메타데이터
- 문서 속성 (작성자, 키워드, 설명)
- 문서 통계 (단어 수, 문자 수)
- 문서 보안 (암호, 편집 제한)

### 3.2 직렬화 (Serialization)
- 많은 기능이 API 레벨에서는 구현되었지만 실제 HWP 파일로 저장될 때 제대로 직렬화되지 않음
- DocInfo 섹션의 완전한 구현 필요
- BodyText 섹션의 컨트롤 처리 개선 필요

### 3.3 유니코드 처리
- UTF-8 문자 경계 처리 개선 (일부 수정됨)
- 특수 문자 및 이모지 지원
- 다국어 텍스트 혼용 처리

### 3.4 성능 최적화
- 대용량 문서 처리
- 메모리 사용량 최적화
- 스트리밍 쓰기 지원

## 4. 우선순위 제안

### 높음 (핵심 기능)
1. 하이퍼링크 serialization 완성
2. 페이지 설정 serialization 완성
3. 이미지 BinData 통합 완성
4. 머리글/바닥글 구현
5. 단락 서식 (정렬, 간격)

### 중간 (자주 사용되는 기능)
1. 텍스트 박스
2. 페이지 나누기
3. 북마크 및 목차
4. 테이블 셀 병합
5. 중첩 리스트

### 낮음 (고급 기능)
1. 각주/미주
2. 수식 편집기
3. 차트 및 도표
4. 양식 컨트롤
5. 문서 보안

## 5. 테스트 필요사항

현재 구현된 기능들도 실제 한글 프로그램에서 제대로 열리고 작동하는지 검증이 필요합니다:

- [ ] 생성된 HWP 파일이 한글 프로그램에서 정상적으로 열리는지
- [ ] 하이퍼링크가 실제로 클릭 가능한지
- [ ] 페이지 설정이 실제로 적용되는지
- [ ] 이미지가 정상적으로 표시되는지
- [ ] 테이블이 올바르게 렌더링되는지
- [ ] 스타일이 정확하게 적용되는지

## 6. 참고사항

이 문서는 2024년 12월 기준으로 작성되었으며, 한글문서파일형식_5.0_완전기술명세서.md를 기반으로 분석한 내용입니다. 실제 구현 시에는 HWP 포맷 스펙을 더 자세히 분석하고, 실제 한글 프로그램에서의 동작을 검증하면서 진행해야 합니다.